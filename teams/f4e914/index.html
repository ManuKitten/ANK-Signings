<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ANK Signings | Sport ANK</title>
    <link rel="stylesheet" href="../../styles/style.css" />
  </head>
  <body>
    <!-- Header -->
    <header>
      <span class="brand"><a href="../../">ANK Signings</a></span>
      <div class="user-profile">
        <img src="../manu1618.png" alt="foto" class="avatar" />
        <span class="username">username</span>
      </div>
    </header>

    <!-- Main -->
    <main>
      <section class="hero">
        <h2>Sport ANK</h2>
        <p>
          Club de Deportes ANK
        </p>
      </section>

      <!-- Features -->
      <section class="features">
        <article class="card">
          <h3>üèüÔ∏è Current League</h3>
          <p>
            Next Match: [CAC] Concepcion Athletic Club
          </p>
        </article>
        <article class="card">
          <h3>‚öΩ Sign Players</h3>
          <p>
            Search players for you to sign
          </p>
        </article>
        <article class="card">
          <h3>üí∞ Handle Finances</h3>
        </article>
        <article class="card">
          <h3>üèÜ Trophy History</h3>
        </article>
      </section>
    </main>

    <!-- Footer -->
    <footer>
      ¬© 2025 ANK Signings. All rights reserved.
    </footer>

    <script>
      const displayName = localStorage.getItem("displayName");
      if (displayName) {
        // Update username text
        document.querySelector(".username").textContent = displayName;
    
        // Update profile picture path
        const avatar = document.querySelector(".avatar");
        avatar.src = `../../media/profiles/${displayName}.png`;
        avatar.alt = `Foto de ${displayName}`;
      }
    </script>
    <script>
      async function sha256(text) {
        const encoder = new TextEncoder();
        const data = encoder.encode(text);
        const hashBuffer = await crypto.subtle.digest("SHA-256", data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
      }
    
      async function personalizeTeamPage() {
        const displayName = localStorage.getItem("displayName");
        if (!displayName) {
          window.location.href = "../../signin";
          return;
        }
    
        // Update profile info
        document.querySelector(".username").textContent = displayName;
        const avatar = document.querySelector(".avatar");
        avatar.src = `../../media/profiles/${displayName}.png`;
        avatar.alt = `Foto de ${displayName}`;
    
        // Fetch team data
        const hash = await sha256(displayName);
        const response = await fetch("../../teams/teams.json");
        const data = await response.json();
        const teamObj = data[hash];
    
        if (teamObj) {
          const team = Object.values(teamObj)[0];
          if (team?.name) {
            document.querySelector("main .hero h2").textContent = team.name;
          }
          if (team?.desc) {
            document.querySelector("main .hero p").textContent = team.desc;
          }
        }
      }
    
      personalizeTeamPage();
    </script>
  </body>
</html>
